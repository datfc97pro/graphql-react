(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{60:function(e,t,n){e.exports=n(88)},65:function(e,t,n){},67:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(50),c=n.n(i),u=(n(65),n(67),n(49)),l=n(10);function o(){var e=Object(u.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    signupUser(username: $username, email: $email, password: $password) {\n      token\n    }\n  }\n"]);return o=function(){return e},e}function s(){var e=Object(u.a)(["\n  mutation($username: String!, $password: String!) {\n    signinUser(username: $username, password: $password) {\n      token\n    }\n  }\n"]);return s=function(){return e},e}function m(){var e=Object(u.a)(["\n  query {\n    getCurrentUser {\n      username\n      joinDate\n      email\n      favorites {\n        _id\n        name\n      }\n    }\n  }\n"]);return m=function(){return e},e}function d(){var e=Object(u.a)(["\n  mutation(\n    $name: String!\n    $description: String!\n    $category: String!\n    $instructions: String!\n    $username: String\n  ) {\n    addRecipe(\n      name: $name\n      description: $description\n      category: $category\n      instructions: $instructions\n      username: $username\n    ) {\n      _id\n      name\n      category\n      description\n      instructions\n      createdDate\n      likes\n    }\n  }\n"]);return d=function(){return e},e}function p(){var e=Object(u.a)(["\n  query($searchTerm: String) {\n    searchRecipes(searchTerm: $searchTerm) {\n      _id\n      name\n      likes\n    }\n  }\n"]);return p=function(){return e},e}function f(){var e=Object(u.a)(["\n  query($_id: ID!) {\n    getRecipe(_id: $_id) {\n      _id\n      name\n      category\n      description\n      instructions\n      createdDate\n      likes\n      username\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=Object(u.a)(["\n  mutation($_id: ID!, $username: String!) {\n    unlikeRecipe(_id: $_id, username: $username) {\n      _id\n      likes\n    }\n  }\n"]);return h=function(){return e},e}function v(){var e=Object(u.a)(["\n  mutation($_id: ID!, $username: String!) {\n    likeRecipe(_id: $_id, username: $username) {\n      _id\n      likes\n    }\n  }\n"]);return v=function(){return e},e}function E(){var e=Object(u.a)(["\n  query($username: String!) {\n    getUserRecipes(username: $username) {\n      _id\n      name\n      likes\n    }\n  }\n"]);return E=function(){return e},e}function g(){var e=Object(u.a)(["\n  mutation($_id: ID!) {\n    deleteUserRecipe(_id: $_id) {\n      _id\n    }\n  }\n"]);return g=function(){return e},e}function b(){var e=Object(u.a)(["\n  query {\n    getAllRecipes {\n      _id\n      name\n      category\n    }\n  }\n"]);return b=function(){return e},e}var y=Object(l.b)(b()),j=Object(l.b)(g()),k=Object(l.b)(E()),O=Object(l.b)(v()),C=Object(l.b)(h()),S=Object(l.b)(f()),w=Object(l.b)(p()),_=Object(l.b)(d()),R=Object(l.b)(m()),$=Object(l.b)(s()),U=Object(l.b)(o()),q=n(4),x=n(76);function A(e){var t=e._id,n=e.name,a=e.category;return r.a.createElement("li",null,r.a.createElement(x.a,{to:"/recipes/".concat(t)},r.a.createElement("h4",null,n)),r.a.createElement("p",null,r.a.createElement("strong",null,a)))}var D=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Home"),r.a.createElement(q.Query,{query:y},function(e){var t=e.data,n=e.loading,a=e.error;return n?r.a.createElement("div",null,"Loading"):a?r.a.createElement("div",null,"Error"):r.a.createElement("ul",null,t.getAllRecipes.map(function(e){return r.a.createElement(A,Object.assign({},e,{key:e._id}))}))}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var N=n(94),Q=n(95),I=n(87),L=n(93),M=n(9),F=n.n(M),B=n(21),Y=n(22),P=n(11),T=n(13),H=n(14),J=n(16),W=n(15),z=n(17);function G(e){var t=e.error;return r.a.createElement("div",null,t.message)}var X=n(96),K={username:"",password:""},V=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(J.a)(this,Object(W.a)(t).call(this,e))).clearState=function(){n.setState(Object(P.a)({},K))},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(Y.a)({},a,r))},n.handleSubmit=function(e,t){e.preventDefault(),t().then(function(){var e=Object(B.a)(F.a.mark(function e(t){var a;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,localStorage.setItem("token",a.signinUser.token),e.next=4,n.props.refetch();case 4:n.clearState(),n.props.history.push("/");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())},n.validateForm=function(){var e=n.state,t=e.username,a=e.password;return!t||!a},n.state=Object(P.a)({},K),n}return Object(z.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.username,a=t.password;return r.a.createElement("div",{className:"App"},r.a.createElement("h2",{className:"App"},"Signin"),r.a.createElement(q.Mutation,{mutation:$,variables:{username:n,password:a}},function(t,i){i.data;var c=i.loading,u=i.error;return r.a.createElement("form",{className:"form",onSubmit:function(n){return e.handleSubmit(n,t)}},r.a.createElement("input",{type:"text",name:"username",placeholder:"Username",onChange:e.handleChange,value:n}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",onChange:e.handleChange,value:a}),r.a.createElement("button",{type:"submit",className:"button-primary",disabled:c||e.validateForm()},"Submit"),u&&r.a.createElement(G,{error:u}))}))}}]),t}(a.Component),Z=Object(X.a)(V),ee={username:"",email:"",password:"",passwordConfirmation:""},te=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(J.a)(this,Object(W.a)(t).call(this,e))).clearState=function(){n.setState(Object(P.a)({},ee))},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(Y.a)({},a,r))},n.handleSubmit=function(e,t){e.preventDefault(),t().then(function(){var e=Object(B.a)(F.a.mark(function e(t){var a;return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.data,localStorage.setItem("token",a.signinUser.token),e.next=4,n.props.refetch();case 4:n.clearState(),n.props.history.push("/");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())},n.validateForm=function(){var e=n.state,t=e.username,a=e.email,r=e.password,i=e.passwordConfirmation;return!t||!a||!r||r!==i},n.state=Object(P.a)({},ee),n}return Object(z.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.username,a=t.email,i=t.password,c=t.passwordConfirmation;return r.a.createElement("div",{className:"App"},r.a.createElement("h2",{className:"App"},"Signup"),r.a.createElement(q.Mutation,{mutation:U,variables:{username:n,email:a,password:i}},function(t,u){u.data;var l=u.loading,o=u.error;return r.a.createElement("form",{className:"form",onSubmit:function(n){return e.handleSubmit(n,t)}},r.a.createElement("input",{type:"text",name:"username",placeholder:"Username",onChange:e.handleChange,value:n}),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",onChange:e.handleChange,value:a}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",onChange:e.handleChange,value:i}),r.a.createElement("input",{type:"password",name:"passwordConfirmation",placeholder:"Confirm Password",onChange:e.handleChange,value:c}),r.a.createElement("button",{type:"submit",className:"button-primary",disabled:l||e.validateForm()},"Submit"),o&&r.a.createElement(G,{error:o}))}))}}]),t}(a.Component),ne=Object(X.a)(te),ae=function(e){return function(t){return r.a.createElement(q.Query,{query:R},function(n){var a=n.data,i=n.loading,c=n.refetch;return i?null:r.a.createElement(e,Object.assign({},t,{refetch:c,session:a}))})}},re=n(92),ie=function(e,t){localStorage.removeItem("token"),e.resetStore(),t.push("/")};var ce=Object(X.a)(function(e){var t=e.history;return r.a.createElement(q.ApolloConsumer,null,function(e){return r.a.createElement("button",{onClick:function(){return ie(e,t)}},"Signout")})});function ue(e){var t=e.session;return r.a.createElement("nav",null,t&&t.getCurrentUser?r.a.createElement(le,{session:t}):r.a.createElement(oe,null))}var le=function(e){var t=e.session;return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(re.a,{to:"/",exact:!0},"Home")),r.a.createElement("li",null,r.a.createElement(re.a,{to:"/search"},"Search")),r.a.createElement("li",null,r.a.createElement(re.a,{to:"/recipe/add"},"Add Recipe")),r.a.createElement("li",null,r.a.createElement(re.a,{to:"/profile"},"Profile")),r.a.createElement("li",null,r.a.createElement(ce,null))),r.a.createElement("h4",null,"Wellcome, ",t.getCurrentUser.username))},oe=function(){return r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(re.a,{to:"/",exact:!0},"Home")),r.a.createElement("li",null,r.a.createElement(re.a,{to:"/search"},"Search")),r.a.createElement("li",null,r.a.createElement(re.a,{to:"/signin"},"Signin")),r.a.createElement("li",null,r.a.createElement(re.a,{to:"/signup"},"Signup")))};function se(e){var t=e._id,n=e.name,a=e.likes;return r.a.createElement("li",null,r.a.createElement(x.a,{to:"recipes/".concat(t)}," ",r.a.createElement("h4",null,n)),r.a.createElement("p",null,"Likes: ",a))}var me=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(J.a)(this,Object(W.a)(t).call(this,e))).handleChange=function(e){var t=e.searchRecipes;n.setState({searchResult:t})},n.state={searchResult:[]},n}return Object(z.a)(t,e),Object(H.a)(t,[{key:"render",value:function(){var e=this,t=this.state.searchResult;return r.a.createElement(q.ApolloConsumer,null,function(n){return r.a.createElement("div",{className:"App"},r.a.createElement("input",{type:"search",name:"searchTerm",placeholder:"Search for Reicpes",onChange:function(){var t=Object(B.a)(F.a.mark(function t(a){var r,i;return F.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.query({query:w,variables:{searchTerm:a.target.value}});case 2:r=t.sent,i=r.data,e.handleChange(i);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}),r.a.createElement("ul",null,t.map(function(e){return r.a.createElement(se,Object.assign({key:e._id},e))})))})}}]),t}(a.Component),de=function(e){return function(t){return function(n){return r.a.createElement(q.Query,{query:R},function(a){var i=a.data,c=a.loading;return a.error,c?null:e(i)?r.a.createElement(t,n):r.a.createElement(L.a,{to:"/"})})}}},pe={name:"",instructions:"",category:"Breakfast",description:"",username:""},fe=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(J.a)(this,Object(W.a)(t).call(this,e))).clearState=function(){n.setState(Object(P.a)({},pe))},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(Y.a)({},a,r))},n.handleSubmit=function(e,t){e.preventDefault(),t().then(function(e){e.data;n.clearState(),n.props.history.push("/")})},n.updateCache=function(e,t){var n=t.data.addRecipe,a=e.readQuery({query:y});a.getAllRecipes.unshift(n),e.writeQuery({query:y,data:a})},n.validateForm=function(){var e=n.state,t=e.name,a=e.category,r=e.description,i=e.instructions;return!t||!a||!r||!i},n.state=Object(P.a)({},pe),n}return Object(z.a)(t,e),Object(H.a)(t,[{key:"componentDidMount",value:function(){this.setState({username:this.props.session.getCurrentUser.username})}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,a=t.category,i=t.description,c=t.instructions,u=t.username;return r.a.createElement(q.Mutation,{mutation:_,variables:{name:n,category:a,description:i,instructions:c,username:u},update:this.updateCache,refetchQueries:function(){return[{query:k,variables:{username:u}}]}},function(t,u){u.data;var l=u.loading,o=u.error;return r.a.createElement("div",{className:"App"},r.a.createElement("h2",{className:"App"},"Add Recipe"),r.a.createElement("form",{className:"form",onSubmit:function(n){return e.handleSubmit(n,t)}},r.a.createElement("input",{type:"text",name:"name",placeholder:"Recipe name",onChange:e.handleChange,value:n}),r.a.createElement("select",{name:"category",onChange:e.handleChange,value:a},r.a.createElement("option",{value:"Breakfast"},"Breakfast"),r.a.createElement("option",{value:"Lunch"},"Lunch"),r.a.createElement("option",{value:"Dinner"},"Dinner"),r.a.createElement("option",{value:"Snack"},"Snack")),r.a.createElement("input",{type:"text",name:"description",onChange:e.handleChange,placeholder:"Add description",value:i}),r.a.createElement("textarea",{name:"instructions",onChange:e.handleChange,placeholder:"Add instructions",value:c}),r.a.createElement("button",{type:"submit",className:"button-primary",disabled:l||e.validateForm()},"Submit"),o&&r.a.createElement(G,{error:o})))})}}]),t}(a.Component),he=de(function(e){return e&&e.getCurrentUser})(Object(X.a)(fe)),ve=n(58),Ee=n.n(ve),ge=function(e){return Ee()(parseInt(e)).format("Do MMM YYYY")};function be(e){var t=e.session;return r.a.createElement("div",null,r.a.createElement("h3",null,"User Info"),r.a.createElement("p",null,"Username: ",t.getCurrentUser.username),r.a.createElement("p",null,"Email: ",t.getCurrentUser.email),r.a.createElement("p",null,"Join Date: ",ge(t.getCurrentUser.joinDate)),r.a.createElement("ul",null,r.a.createElement("h3",null,t.getCurrentUser.username,"'s Favorites"),t.getCurrentUser.favorites.map(function(e){return r.a.createElement("li",{key:e._id},r.a.createElement(x.a,{to:"/recipes/".concat(e._id)},r.a.createElement("p",null,e.name)))}),!t.getCurrentUser.favorites.length&&r.a.createElement("p",null,r.a.createElement("strong",null,"You have no favorites currently. Go add some!"))))}var ye=function(e){window.confirm("Are you sure you want to delete this recipe?")&&e().then(function(e){e.data})};function je(e){var t=e.username;return r.a.createElement(q.Query,{query:k,variables:{username:t}},function(e){var n=e.data,a=e.loading,i=e.error;return a?r.a.createElement("div",null,"Loading"):i?r.a.createElement("div",null,"Error"):r.a.createElement("ul",null,r.a.createElement("h3",null,"You Recipes"),!n.getUserRecipes.length&&r.a.createElement("p",null,r.a.createElement("strong",null,"You have not added any recipes yet")),n.getUserRecipes.map(function(e){return r.a.createElement("li",{key:e._id},r.a.createElement(x.a,{to:"/recipes/".concat(e._id)},r.a.createElement("p",null,e.name)),r.a.createElement("p",{style:{marginBottom:"0"}},"Likes: ",e.likes),r.a.createElement(q.Mutation,{mutation:j,variables:{_id:e._id},refetchQueries:function(){return[{query:y},{query:R}]},update:function(e,n){var a=n.data.deleteUserRecipe,r=e.readQuery({query:k,variables:{username:t}}).getUserRecipes;e.writeQuery({query:k,variables:{username:t},data:{getUserRecipes:r.filter(function(e){return e._id!==a._id})}})}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.a.createElement("p",{className:"delete-button",onClick:function(){return ye(e)}},t.loading?"deleting...":"X")}))}))})}var ke=de(function(e){return e&&e.getCurrentUser})(function(e){var t=e.session;return r.a.createElement("div",{className:"App"},r.a.createElement(be,{session:t}),r.a.createElement(je,{username:t.getCurrentUser.username}))}),Oe=ae(function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(J.a)(this,Object(W.a)(t).call(this,e))).handleClick=function(e,t){n.setState(function(e){return{liked:!e.liked}},function(){return n.handleLike(e,t)})},n.handleLike=function(e,t){n.state.liked?e().then(function(){var e=Object(B.a)(F.a.mark(function e(t){return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.data,e.next=3,n.props.refetch();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()):t().then(function(){var e=Object(B.a)(F.a.mark(function e(t){return F.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.data,e.next=3,n.props.refetch();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())},n.updateLike=function(e,t){var a=t.data.likeRecipe,r=n.props._id,i=e.readQuery({query:S,variables:{_id:r}}).getRecipe;e.writeQuery({query:S,variables:{_id:r},data:{getRecipe:Object(P.a)({},i,{likes:a.likes+1})}})},n.undateUnlike=function(e,t){var a=t.data.unlikeRecipe,r=n.props._id,i=e.readQuery({query:S,variables:{_id:r}}).getRecipe;e.writeQuery({query:S,variables:{_id:r},data:{getRecipe:Object(P.a)({},i,{likes:a.likes-1})}})},n.state={liked:!1,username:""},n}return Object(z.a)(t,e),Object(H.a)(t,[{key:"componentDidMount",value:function(){if(this.props.session.getCurrentUser){var e=this.props.session.getCurrentUser,t=e.username,n=e.favorites,a=this.props._id,r=n.findIndex(function(e){return e._id===a})>-1;this.setState({username:t,liked:r})}}},{key:"render",value:function(){var e=this,t=this.state.username,n=this.props._id;return r.a.createElement(q.Mutation,{mutation:C,variables:{_id:n,username:t}},function(a){return r.a.createElement(q.Mutation,{mutation:O,variables:{_id:n,username:t}},function(n){return t&&r.a.createElement("button",{onClick:function(){return e.handleClick(n,a)}},e.state.liked?"Unlike":"Like")})})}}]),t}(a.Component));var Ce=Object(X.a)(function(e){var t=e.match.params._id;return r.a.createElement(q.Query,{query:S,variables:{_id:t}},function(e){var n=e.data,a=e.loading,i=e.error;return a?r.a.createElement("div",null,"Loading"):i?r.a.createElement("div",null,"Error"):r.a.createElement("div",{className:"App"},r.a.createElement("h2",null,n.getRecipe.name),r.a.createElement("p",null,"Category: ",n.getRecipe.category),r.a.createElement("p",null,"Descriptions: ",n.getRecipe.description),r.a.createElement("p",null,"Instructions: ",n.getRecipe.instructions),r.a.createElement("p",null,"Likes: ",n.getRecipe.likes),r.a.createElement("p",null,"Created By: ",n.getRecipe.username),r.a.createElement(Oe,{_id:t}))})}),Se=new l.a({uri:"/graphql",fetchOptions:{credentials:"include"},request:function(e){var t=localStorage.getItem("token");e.setContext({headers:{authorization:t}})},onError:function(e){var t=e.networkError;t&&401===t.statusCode&&localStorage.removeItem("token")}}),we=ae(function(e){var t=e.refetch,n=e.session;return r.a.createElement(N.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(ue,{session:n}),r.a.createElement(Q.a,null,r.a.createElement(I.a,{path:"/",exact:!0,component:D}),r.a.createElement(I.a,{path:"/search",component:me}),r.a.createElement(I.a,{path:"/signin",render:function(){return r.a.createElement(Z,{refetch:t})}}),r.a.createElement(I.a,{path:"/signup",render:function(){return r.a.createElement(ne,{refetch:t})}}),r.a.createElement(I.a,{path:"/recipe/add",render:function(){return r.a.createElement(he,{session:n})}}),r.a.createElement(I.a,{path:"/recipes/:_id",component:Ce}),r.a.createElement(I.a,{path:"/profile",render:function(){return r.a.createElement(ke,{session:n})}}),r.a.createElement(L.a,{to:"/"}))))});c.a.render(r.a.createElement(q.ApolloProvider,{client:Se},r.a.createElement(we,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[60,2,1]]]);
//# sourceMappingURL=main.71204fe0.chunk.js.map